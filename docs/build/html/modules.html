
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>mm8 &#8212; mm8 watery documentation</title>
    <link rel="stylesheet" href="_static/classic.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="_static/language_data.js"></script>
    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="Introduction" href="intro.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="intro.html" title="Introduction"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">mm8 watery documentation</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="module-mm8">
<span id="mm8"></span><h1>mm8<a class="headerlink" href="#module-mm8" title="Permalink to this headline">¶</a></h1>
<dl class="simple">
<dt>The mm8 Python package contains the following modules</dt><dd><ul class="simple">
<li><p>‘reading’ importing 1D and 2D NMR data</p></li>
<li><p>‘plotting’ visualisation functions</p></li>
<li><p>‘preproc’ NMR preprocessing functions</p></li>
<li><p>‘analyse’ statistical analysis of NMR spectra</p></li>
<li><p>‘utility’ helper functions</p></li>
</ul>
</dd>
</dl>
<span class="target" id="module-mm8.reading"></span><p>This module imports 1D and 2D NMR spectra</p>
<dl class="function">
<dt id="mm8.reading.import2dJres">
<code class="sig-prename descclassname">mm8.reading.</code><code class="sig-name descname">import2dJres</code><span class="sig-paren">(</span><em class="sig-param">path</em><span class="sig-paren">)</span><a class="headerlink" href="#mm8.reading.import2dJres" title="Permalink to this definition">¶</a></dt>
<dd><p>Imports a single 2D processed NMR spectrum</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>path</strong> – Path to experiment directory</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>X, ppm1, ppm2</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Tuple of three</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="mm8.reading.import2d_procs">
<code class="sig-prename descclassname">mm8.reading.</code><code class="sig-name descname">import2d_procs</code><span class="sig-paren">(</span><em class="sig-param">flist</em>, <em class="sig-param">exp_type</em>, <em class="sig-param">calib=True</em>, <em class="sig-param">n_max=10000</em><span class="sig-paren">)</span><a class="headerlink" href="#mm8.reading.import2d_procs" title="Permalink to this definition">¶</a></dt>
<dd><p>Imports 2D processed NMR spectra</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>flist</strong> – DataFrame of experiment information (see list_exp())</p></li>
<li><p><strong>exp_type</strong> – 2D experiment name, string (used for filtering)</p></li>
<li><p><strong>calib</strong> – Chemical shift calibration to TSP (log)</p></li>
<li><p><strong>n_max</strong> – Max number of spectra to read-in (int)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>X, ppm1, opm2, meta</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Tuple of four</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="mm8.reading.import2d_raw">
<code class="sig-prename descclassname">mm8.reading.</code><code class="sig-name descname">import2d_raw</code><span class="sig-paren">(</span><em class="sig-param">flist</em>, <em class="sig-param">exp_type</em>, <em class="sig-param">calib=True</em>, <em class="sig-param">n_max=10000</em><span class="sig-paren">)</span><a class="headerlink" href="#mm8.reading.import2d_raw" title="Permalink to this definition">¶</a></dt>
<dd><p>Import 2D raw NMR data</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>flist</strong> – DataFrame of experiment information (see list_exp())</p></li>
<li><p><strong>exp_type</strong> – 2D experiment name, string (used for filtering)</p></li>
<li><p><strong>calib</strong> – Chemical shift calibration to TSP, logic</p></li>
<li><p><strong>n_max</strong> – Maximum number of experiment read-ins (int)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>X, ppm1, ppm2</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Tuple of three</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="mm8.reading.list_exp">
<code class="sig-prename descclassname">mm8.reading.</code><code class="sig-name descname">list_exp</code><span class="sig-paren">(</span><em class="sig-param">path</em>, <em class="sig-param">return_results=False</em>, <em class="sig-param">pr=True</em><span class="sig-paren">)</span><a class="headerlink" href="#mm8.reading.list_exp" title="Permalink to this definition">¶</a></dt>
<dd><p>List all NMR experiment files in directory</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>path</strong> – Directory path (string)</p></li>
<li><p><strong>return_results</strong> – return DataFrame containing file information (logic)</p></li>
<li><p><strong>pr</strong> – Print overview table in console</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>DataFrame of NMR experiment information - input for importing functions</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="mm8.reading.read1d2d">
<code class="sig-prename descclassname">mm8.reading.</code><code class="sig-name descname">read1d2d</code><span class="sig-paren">(</span><em class="sig-param">ll, exps=['PROF_URINE_NOESY', 'PROF_URINE_JRES'], n_max=100</em><span class="sig-paren">)</span><a class="headerlink" href="#mm8.reading.read1d2d" title="Permalink to this definition">¶</a></dt>
<dd><p>Imports 1D and 2D processed NMR spectra</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ll</strong> – DataFrame of experiment information (see list_exp())</p></li>
<li><p><strong>exps</strong> – Ordered list of two: 1d and 2D experiment names (used for filtering)</p></li>
<li><p><strong>n_max</strong> – Maximum number of experiment read-ins (int)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>X, ppm, meta, X2, ppm1, ppm2, meta2</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Tuple of seven</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="mm8.reading.read1d2d_raw">
<code class="sig-prename descclassname">mm8.reading.</code><code class="sig-name descname">read1d2d_raw</code><span class="sig-paren">(</span><em class="sig-param">ll, exps=['PROF_URINE_NOESY', 'PROF_URINE_JRES'], n_max=100</em><span class="sig-paren">)</span><a class="headerlink" href="#mm8.reading.read1d2d_raw" title="Permalink to this definition">¶</a></dt>
<dd><p>Import matching 1D processed and 2D raw NMR data</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ll</strong> – DataFrame of experiment information (see list_exp())</p></li>
<li><p><strong>exps</strong> – Ordered list of two: 1d and 2D experiment names (used for filtering)</p></li>
<li><p><strong>n_max</strong> – Maximum number of experiment read-ins (int)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>X, ppm, met, X2, ppm1, ppm2</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Tuple of six</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="mm8.reading.read1dFID">
<code class="sig-prename descclassname">mm8.reading.</code><code class="sig-name descname">read1dFID</code><span class="sig-paren">(</span><em class="sig-param">path</em>, <em class="sig-param">win</em>, <em class="sig-param">ret='fid'</em>, <em class="sig-param">zf=2</em><span class="sig-paren">)</span><a class="headerlink" href="#mm8.reading.read1dFID" title="Permalink to this definition">¶</a></dt>
<dd><p>Import raw FID</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>path</strong> – Directory to acqus file</p></li>
<li><p><strong>win</strong> – Window function (see utility module)</p></li>
<li><p><strong>ret</strong> – String indicating which data to return  (fid, win, zf, fft)</p></li>
<li><p><strong>zf</strong> – Int zero-filling factor (e.g., 2: double the number data points)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Data array depending on ret argument</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="mm8.reading.sqrt_quadratic">
<code class="sig-prename descclassname">mm8.reading.</code><code class="sig-name descname">sqrt_quadratic</code><span class="sig-paren">(</span><em class="sig-param">x</em><span class="sig-paren">)</span><a class="headerlink" href="#mm8.reading.sqrt_quadratic" title="Permalink to this definition">¶</a></dt>
<dd><p>L2 norm</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>x</strong> – numeric array of rank 1</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Skalar</p>
</dd>
</dl>
</dd></dl>

<span class="target" id="module-mm8.plotting"></span><p>Created on Sun Aug  1 10:39:29 2021</p>
<p>&#64;author: torbenkimhofer</p>
<dl class="function">
<dt id="mm8.plotting.ispec">
<code class="sig-prename descclassname">mm8.plotting.</code><code class="sig-name descname">ispec</code><span class="sig-paren">(</span><em class="sig-param">x</em>, <em class="sig-param">ppm</em>, <em class="sig-param">shift=None</em>, <em class="sig-param">theme='gridon'</em>, <em class="sig-param">lab=None</em><span class="sig-paren">)</span><a class="headerlink" href="#mm8.plotting.ispec" title="Permalink to this definition">¶</a></dt>
<dd><p>Interactive plotting a single or multiple 1D NMR spectra</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> – NMR data array (rank 1 or 2)</p></li>
<li><p><strong>ppm</strong> – Chemical shift array (rank 1)</p></li>
<li><p><strong>shift</strong> – Chemical shift interval (list)</p></li>
<li><p><strong>theme</strong> – plotly theme (str)</p></li>
<li><p><strong>lab</strong> – Line labels for spectrum/spectra</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>NULL</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="mm8.plotting.ispec2d">
<code class="sig-prename descclassname">mm8.plotting.</code><code class="sig-name descname">ispec2d</code><span class="sig-paren">(</span><em class="sig-param">x, ppm1, ppm2, shift1=[-10, 10], shift2=[3, 3.1], theme='gridon', ptype='surface', log10=False, return_fig=False</em><span class="sig-paren">)</span><a class="headerlink" href="#mm8.plotting.ispec2d" title="Permalink to this definition">¶</a></dt>
<dd><p>Interactive plotting a single 2D NMR spectrum</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> – NMR data array (rank 2, f1 in first dimension)</p></li>
<li><p><strong>ppm1</strong> – Chemical shift array f1 (rank 1)</p></li>
<li><p><strong>ppm2</strong> – Chemical shift array f2 (rank 1)</p></li>
<li><p><strong>shift1</strong> – Chemical shift interval f1 (list)</p></li>
<li><p><strong>shift2</strong> – Chemical shift interval f2 (list)</p></li>
<li><p><strong>theme</strong> – Plotly theme (str)</p></li>
<li><p><strong>ptype</strong> – Plot type as str: surface or contour</p></li>
<li><p><strong>log10</strong> – Log transformation of x</p></li>
<li><p><strong>return_fig</strong> – Logic, plotly obj return</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Null or plotly obj</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="mm8.plotting.spec">
<code class="sig-prename descclassname">mm8.plotting.</code><code class="sig-name descname">spec</code><span class="sig-paren">(</span><em class="sig-param">x</em>, <em class="sig-param">ppm</em>, <em class="sig-param">shift=None</em>, <em class="sig-param">ax=None</em>, <em class="sig-param">xlab='ppm'</em>, <em class="sig-param">ylab='Int'</em>, <em class="sig-param">title=None</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#mm8.plotting.spec" title="Permalink to this definition">¶</a></dt>
<dd><p>Plotting a single or multiple 1D NMR spectra</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> – NMR data array (rank 1 or 2)</p></li>
<li><p><strong>ppm</strong> – Chemical shift array (rank 1)</p></li>
<li><p><strong>shift</strong> – Chemical shift interval (list)</p></li>
<li><p><strong>ax</strong> – Pyplot axis object for adding to exisiting plot</p></li>
<li><p><strong>xlab</strong> – X-axis label (str)</p></li>
<li><p><strong>ylab</strong> – Y-axis lable (str)</p></li>
<li><p><strong>title</strong> – Plot title</p></li>
<li><p><strong>**kwargs**</strong> – Additional arguments passed on to matplotlib.pyplot</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Calibrated NMR array</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="mm8.plotting.sub2d1d">
<code class="sig-prename descclassname">mm8.plotting.</code><code class="sig-name descname">sub2d1d</code><span class="sig-paren">(</span><em class="sig-param">x</em>, <em class="sig-param">ppm</em>, <em class="sig-param">x2</em>, <em class="sig-param">ppm1</em>, <em class="sig-param">ppm2</em>, <em class="sig-param">f1</em>, <em class="sig-param">f2</em>, <em class="sig-param">mdist=5</em>, <em class="sig-param">thr_abs='auto_100'</em>, <em class="sig-param">log10=True</em><span class="sig-paren">)</span><a class="headerlink" href="#mm8.plotting.sub2d1d" title="Permalink to this definition">¶</a></dt>
<dd><p>Combined 1D and 2D NMR plot (two panels)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> – Single 1D NMR spectrum as array (rank 1)</p></li>
<li><p><strong>ppm</strong> – Chemical shift array for 1D (rank 1)</p></li>
<li><p><strong>x2</strong> – Single 2D NMR spectrum as array (rank 2, f1 in first dimension)</p></li>
<li><p><strong>ppm1</strong> – Chemical shift array f1 for 2D (rank 1)</p></li>
<li><p><strong>ppm2</strong> – Chemical shift array f2 for 2D (rank 1)</p></li>
<li><p><strong>f1</strong> – Chemical shift interval f1 (list)</p></li>
<li><p><strong>f2</strong> – Chemical shift interval f2 (list)</p></li>
<li><p><strong>mdist</strong> – Peak picking parameter - min distance</p></li>
<li><p><strong>thr_abs</strong> – Peak picking parameter - noise intensity threshold</p></li>
<li><p><strong>log10</strong> – Log transformation of x</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Null</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="mm8.plotting.sub2d_max">
<code class="sig-prename descclassname">mm8.plotting.</code><code class="sig-name descname">sub2d_max</code><span class="sig-paren">(</span><em class="sig-param">X1</em>, <em class="sig-param">ppm1</em>, <em class="sig-param">ppm2</em>, <em class="sig-param">f1</em>, <em class="sig-param">f2</em>, <em class="sig-param">mdist=5</em>, <em class="sig-param">thr_abs=2000</em>, <em class="sig-param">log10=True</em>, <em class="sig-param">lab=None</em>, <em class="sig-param">plist=None</em><span class="sig-paren">)</span><a class="headerlink" href="#mm8.plotting.sub2d_max" title="Permalink to this definition">¶</a></dt>
<dd><p>Contour plot of multiple 2D NMR spectra in horizontal panels</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X1</strong> – 2D NMR data array (rank 2, f1 in first dimension)</p></li>
<li><p><strong>ppm1</strong> – Chemical shift array f1 (rank 1)</p></li>
<li><p><strong>ppm2</strong> – Chemical shift array f2 (rank 1)</p></li>
<li><p><strong>f1</strong> – Chemical shift interval f1 (list)</p></li>
<li><p><strong>f2</strong> – Chemical shift interval f2 (list)</p></li>
<li><p><strong>mdist</strong> – Peak picking parameter - min distance</p></li>
<li><p><strong>thr_abs</strong> – Peak picking parameter - noise intensity threshold</p></li>
<li><p><strong>lab</strong> – Plot title</p></li>
<li><p><strong>plist</strong> – Provide peak list</p></li>
<li><p><strong>log10</strong> – Log transformation of x</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Null</p>
</dd>
</dl>
</dd></dl>

<span class="target" id="module-mm8.preproc"></span><p>Pre-processing fucntions for 1D and 2D NMR data</p>
<dl class="function">
<dt id="mm8.preproc.calibrate_doubl">
<code class="sig-prename descclassname">mm8.preproc.</code><code class="sig-name descname">calibrate_doubl</code><span class="sig-paren">(</span><em class="sig-param">X</em>, <em class="sig-param">ppm</em>, <em class="sig-param">cent_ppm</em>, <em class="sig-param">j_hz</em>, <em class="sig-param">lw=0.5</em>, <em class="sig-param">tol_ppm=0.03</em>, <em class="sig-param">niter_bl=5</em><span class="sig-paren">)</span><a class="headerlink" href="#mm8.preproc.calibrate_doubl" title="Permalink to this definition">¶</a></dt>
<dd><p>Calibrate spectra to a doublet (e.g. plasma to glucose at 5.23 ppm with j_hz=6, alanine at 1.491 ppm with j_hz=6, lactate at 1.35 ppm with j_hz=6)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> – NMR data array (rank 1 or 2)</p></li>
<li><p><strong>ppm</strong> – Chemical shift array (rank 1)</p></li>
<li><p><strong>cent_pos</strong> – Expected chemical shift of doublet</p></li>
<li><p><strong>j_hz</strong> – Expected J constant of doublet</p></li>
<li><p><strong>lw</strong> – Expected line width of doublet</p></li>
<li><p><strong>tol_ppm</strong> – Chemical shift tolerance for doublet</p></li>
<li><p><strong>niter_bl</strong> – Maximum of iterations for basline correction (asymmetric least squares)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>X - aligned NMR data</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="mm8.preproc.excise1d">
<code class="sig-prename descclassname">mm8.preproc.</code><code class="sig-name descname">excise1d</code><span class="sig-paren">(</span><em class="sig-param">X</em>, <em class="sig-param">ppm</em><span class="sig-paren">)</span><a class="headerlink" href="#mm8.preproc.excise1d" title="Permalink to this definition">¶</a></dt>
<dd><p>Excist spectral intervals using pre-defined limits: Kept is 0.25- 4.5 ppm and 5-10 ppm</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> – NMR data array (rank 1 or 2)</p></li>
<li><p><strong>ppm</strong> – Chemical shift array (rank 1)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>X, ppm</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Tuple of two</p>
</dd>
</dl>
</dd></dl>

<dl class="class">
<dt id="mm8.preproc.pca">
<em class="property">class </em><code class="sig-prename descclassname">mm8.preproc.</code><code class="sig-name descname">pca</code><span class="sig-paren">(</span><em class="sig-param">X</em>, <em class="sig-param">ppm</em>, <em class="sig-param">nc=2</em>, <em class="sig-param">center=True</em>, <em class="sig-param">scale='uv'</em><span class="sig-paren">)</span><a class="headerlink" href="#mm8.preproc.pca" title="Permalink to this definition">¶</a></dt>
<dd><p>Principla Components Analysis class and plotting fcts
TODO: Annotation</p>
</dd></dl>

<dl class="function">
<dt id="mm8.preproc.pqn">
<code class="sig-prename descclassname">mm8.preproc.</code><code class="sig-name descname">pqn</code><span class="sig-paren">(</span><em class="sig-param">x_raw</em>, <em class="sig-param">log=False</em><span class="sig-paren">)</span><a class="headerlink" href="#mm8.preproc.pqn" title="Permalink to this definition">¶</a></dt>
<dd><p>Probabilistic Quotient Normalisation using median spectrum as reference and median quotient as dilution coefficient</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x_raw</strong> – NMR data array (rank 1 or 2)</p></li>
<li><p><strong>log</strong> – log transform prior to dilution coefficient calculation</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Xn, DataFrame of dilution coefficients</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Tuple of two</p>
</dd>
</dl>
</dd></dl>

<span class="target" id="module-mm8.analyse"></span><p>Analysis functions
&#64;author: torbenkimhofer</p>
<dl class="class">
<dt id="mm8.analyse.pca">
<em class="property">class </em><code class="sig-prename descclassname">mm8.analyse.</code><code class="sig-name descname">pca</code><span class="sig-paren">(</span><em class="sig-param">X</em>, <em class="sig-param">ppm</em>, <em class="sig-param">nc=2</em>, <em class="sig-param">center=True</em>, <em class="sig-param">scale='uv'</em><span class="sig-paren">)</span><a class="headerlink" href="#mm8.analyse.pca" title="Permalink to this definition">¶</a></dt>
<dd><p>Create PCA class</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> – NMR matrix rank 2</p></li>
<li><p><strong>ppm</strong> – chemical shift vector rank 1</p></li>
<li><p><strong>pc</strong> – Number of desired principal components</p></li>
<li><p><strong>center</strong> – boolean, mean centering</p></li>
<li><p><strong>scale</strong> – ‘uv’</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>pca class</p>
</dd>
</dl>
<dl class="method">
<dt id="mm8.analyse.pca.plot_load">
<code class="sig-name descname">plot_load</code><span class="sig-paren">(</span><em class="sig-param">pc=1, shift=[0, 10]</em><span class="sig-paren">)</span><a class="headerlink" href="#mm8.analyse.pca.plot_load" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot statistical reconstruction of PCA loadings</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pc</strong> – Index of principal components, starting at 1</p></li>
<li><p><strong>shift</strong> – Chemical shift range (list of 2)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>plotting object</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="mm8.analyse.pca.plot_scores">
<code class="sig-name descname">plot_scores</code><span class="sig-paren">(</span><em class="sig-param">an, pc=[1, 2], hue=None, legend_loc='right'</em><span class="sig-paren">)</span><a class="headerlink" href="#mm8.analyse.pca.plot_scores" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot PCA scores (2D)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>an</strong> – Pandas DataFrame containig colouring variable as column</p></li>
<li><p><strong>pc</strong> – List of indices of principal components, starting at 1, length of two</p></li>
<li><p><strong>hue</strong> – Column name in an of colouring variable</p></li>
<li><p><strong>legend_loc</strong> – Legend locatoin given as string (‘right’, ‘left’,</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>plotting object</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="mm8.analyse.stocsy">
<em class="property">class </em><code class="sig-prename descclassname">mm8.analyse.</code><code class="sig-name descname">stocsy</code><span class="sig-paren">(</span><em class="sig-param">X</em>, <em class="sig-param">ppm</em><span class="sig-paren">)</span><a class="headerlink" href="#mm8.analyse.stocsy" title="Permalink to this definition">¶</a></dt>
<dd><p>Create STOCSY class</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> – NMR matrix rank 2</p></li>
<li><p><strong>ppm</strong> – chemical shift vector rank 1</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>class stocsy</p>
</dd>
</dl>
<dl class="method">
<dt id="mm8.analyse.stocsy.trace">
<code class="sig-name descname">trace</code><span class="sig-paren">(</span><em class="sig-param">d, shift=[0, 10], interactive=True</em><span class="sig-paren">)</span><a class="headerlink" href="#mm8.analyse.stocsy.trace" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform STOCSY analysis</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>d</strong> – Driver peak position (ppm)</p></li>
<li><p><strong>shift</strong> – Chemical shift range as list of length two</p></li>
<li><p><strong>interactive</strong> – boolean, True for plotly, False for plotnine</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>graphics object</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<div class="toctree-wrapper compound">
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h4>Previous topic</h4>
  <p class="topless"><a href="intro.html"
                        title="previous chapter">Introduction</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/modules.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="intro.html" title="Introduction"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">mm8 watery documentation</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2021, Torben Kimhofer.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 2.2.0.
    </div>
  </body>
</html>